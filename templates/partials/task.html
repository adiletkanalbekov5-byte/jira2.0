<div class="task bg-gray-700 p-5 rounded-xl shadow-lg border border-gray-600"
     id="task-{{ task.id }}">
    <h3 class="font-bold text-lg text-yellow-300">{{ task.title }}</h3>
    {% if task.description %}
        <p class="text-gray-300 text-sm mt-2">{{ task.description|truncatewords:20 }}</p>
    {% endif %}
    {% if task.assignee %}
        <div class="mt-3 flex items-center gap-2">
            <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium">
                {{ task.assignee.username }}
            </span>
        </div>
    {% endif %}
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script>
['todo','progress','done'].forEach(col => {
    new Sortable(document.getElementById(col), {
        group: 'board',
        animation: 200,
        onEnd: function(e) {
            const id = e.item.dataset.id;
            const to = e.to.id;
            fetch(`/task/${id}/update/`, {  // используем существующий update URL
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: 'status=' + to
            }).then(() => location.reload());
        }
    });
});
</script>
